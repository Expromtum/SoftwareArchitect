## Бизнес-контекст 

Университету нужна автоматизация оценки заданий по программированию. На реализацию выделен очень маленький бюджет
## Бизнес-цели

* Автоматизировать проверку выполненных студентами заданий по программированию
* Реализовать возможность проверки оценок за задания государственным регулирующим органом
##  Бизнес-драйверы  (проблемы, которые нужно решить)

- Доработки университетской системы управления обучением (LMS) очень тяжелы
- Максимально дешевая разработка и поддержка
- Разделение прав доступа для преподавателей, студентов, аудиторов
- Задания и оценки за них должны храниться с историей изменений
- Формирование заданий с метриками и тестами, сроком выполнения преподавателем
- Интерфейс просмотра и загрузки заданий для студентов
- Выполнение кода решения в runtime <span style="color:red">(уточнить список языков программирования)</span>
- Проверка загруженных решений автоматическими тестами
- Обнаружение плагиата путем сравнения с выполненным заданием других студентов <span style="color:red">(уточнить, сравнение на дату загрузки задания или на дату срока выполнения?)</span>
- Интеграция с системой обнаружения плагиата TurnItIn
- Расчет оценки за выполненное задание согласно выполнению метрик, тестов, проценту плагиата
- Интеграция с системой управления обучением университета LMS на мэйнфрейме <span style="color:red">Какой мэйнфрейм у системы управления обучением в задании не сказано, метод интеграции тоже не указан. 
Можно пока предположить, что это RPC</span>
- Интерфейс проверки выполненных заданий для преподавателя/аудитора
## Стейкхолдеры и их потребности 
- **Администратор**
	Специалист, управляющий учетными записями пользователей в системе с назначением прав доступа
- **Преподаватель** 
	Создает список заданий для курса/предмета
	Устанавливает сроки сдачи заданий и критерии оценки (метрики и тесты)
	Проверяет выставленные оценки за задания
- **Аудитор** (Сотрудник государственного регулирующего органа)
	* Проверяет выставленные оценки за задания
	- Ему нужна "прозрачность" оценки, т.е. аудитор должен видеть метрики и успешность выполнения тестов, процент плагиата
- **Студент**
	- Загружает задания для проверки в систему
	- Хочет иметь возможность загрузить задания в систему неограниченное количество раз
	- Ему нужна "прозрачность" оценки, т.е. студент должен видеть метрики и успешность выполнения тестов, процент плагиата
- **Команда разработки**	

## Пользовательские истории (use case) 

**UC-1: Обслуживание пользователей**
Администратор ведет учетные записи пользователей системы.
Администратор настраивает доступ к интерфейсам системы для пользователей

**UC-2 Отправка работы на проверку студентом**
- Студент входит в систему по логину/паролю
- Студент открывает интерфейс со списком назначенных ему заданий

 Интерфейс просмотра заданий студентов с отображением:
	- срока выполнения задания 
	- статуса запуска (запустилось/не запустилось)
	- процента выполненных метрик и результата пройденных тестов
	- процента плагиата
	- полученной оценки
	- прикрепленных файлов решения
	- истории загруженных решений 

- Студент выбирает задание с не истекшим сроком выполнения
- Студент загружает решение выбранного задания в систему
- Система создает новую запись с решением по выбранному заданию с отметкой времени загрузки в систему
- После сохранения решения в базу данных оно автоматически отправляется на проверку
- Студент может отменить проверку решения и загрузить новое решение
- Количество загрузок решений не ограничено

**UC-3: Workflow проверки выполненного задания**
Система для заданного решения задания:
- проверяет: не истек ли срок выполнения задания
- запускает решение задания на выполнение в runtime
- проверяет выполнение тестов
- рассчитывает процент плагиата, сравнивая с другими присланными ранее решениями студентов
- проверяет решение на наличие плагиата, отправляя его в TurnItIn
- считает метрики
- рассчитывает и присваивает заданию итоговую оценку

- на любом из этапов проверка прерывается со сбросом результатов, если студент отменил проверку

**UC-4: Формирование заданий преподавателем**
- Преподаватель входит в систему по логину/паролю
- Преподаватель открывает интерфейс списка заданий по курсам
- Добавляет новое или изменяет задание в статусе "Подготовка"
	- Устанавливает срок выполнения задания
	- Прикрепляет к заданию метрики и тесты (включая максимальное время ожидания ответа программы)
	- Переводит задание в статус "Активно", чтобы задание появилось в списках заданий у студентов
	- При необходимости переводит статус задания в "Отменено" или "Подготовка" (только для заданий с не истекшим сроком выполнения)

**UC-5 Проверка оценок аудитором/преподавателем**
- Аудитор/преподаватель входит в систему по логину/паролю
- Аудитор/преподаватель открывает интерфейс с выставленными оценками за задания. Выбирает курс, отображается таблица со списком студентов и списком назначенных заданий с выставленными оценками.
- В интерфейсе можно открыть детализацию задания с итогами тестирования, выполненных метрик, процентом плагиата и оценкой

**UC-6 Интеграция с системой проверки плагиата TurnItIn**
**По таймеру, запускаемому каждые 10 минут** система отправляет в TurnItIn еще непроверенные на плагиат решения заданий, чтобы гарантировать "повторение" неудачных запросов к TurnItIn (могут возникнуть из-за сбоев в обслуживании или окон обслуживания до 8 часов).
Если ответ от системы (в виде вебхука) не получен через 30 минут (и каждые 30 минут после этого), выполняется "опрос" TurnItIn по специальному URL, чтобы получить статус проверки уже отправленного задания.
см. https://developers.turnitin.com/turnitin-core-api/best-practice/retry-polling

**UC-7 Интеграция с системой управления обучением университета (LMS)** ****(Простой вариант по таймеру)**
- Система через заданный интервал отправляет оценки студентов в LMS по решениям заданий, загруженных последними, у которых истек срок выполнения, и которые еще не отправлены в LMS
- После успешной отправки оценок задания  помечаются флагом "Отправлено в LMS"
- Если при отправке в LMS возникла ошибка, задания помечаются флагом "Ошибка отправки в LMS". Ошибка сохраняется в журнал ошибок

## Атрибуты качества (и не функциональные требования) 

**Безопасность**
- Необходимо разделение прав доступа к системе для преподавателей, студентов, аудиторов

**Эффективность**
- Время отклика < 2 сек при загрузке страницы 
- Время проверки работы студента не более 3 часов (из-за особенностей работы с TurnItIn), за исключением окон обслуживания TurnItIn (они случаются редко, но могут длиться до 8 часов)

**Удобство использования**
- Возможность повторной загрузки задания студентом для проверки

**Повторяемость**
- Оценки и выполнение кода должны быть персистентными и поддающимися проверке

**Надежность**
- Доступность системы 98% (3.36 часов  в неделю, или 0,48 часа в день система может быть недоступна)

**Пользовательский интерфейс**
- Веб-интерфейс, совместимый с разными браузерами

##  Изобразите контекстную схему системы 

См. каталог scheme

## Критические сценарии и критические характеристики

**Критичные сценарии:** 

- Преподаватели составляют список заданий с метриками и тестами
- Студенты загружают выполненные задания в систему
- Система запускает загруженные задания и согласно метрикам, тестам, контролю плагиата выставляет оценки за задания
- Система выгружает выставленные оценки в систему управления обучением (LMS)
- Аудитор проверяет выставленные оценки за задания

**Критичные характеристики:** 

- Стоимость разработки (budget/cost) - максимально дешево

## Альтернативные решения с оценкой рисков, возможностей и т.д.

No-Code и Low-Code платформы предназначены для решения типовых задач - интернет-магазины, лендинги, портфолио, корпоративные сайты, блоги и прочее, что легко стандартизировать. 
Задача проверки студенческих работа нестандартная, значит решение нужно писать с нуля.

У приложения нет требований к масштабируемости, небольшое количество пользователей, простая модель данных и очень ограниченный бюджет. 

Простую модель данных можно реализовать для ускорения разработки с помощью ORM.

**Варианты решения:**
#### **1. Backend на Java Spring Boot + frontend на React

**Скорость разработки (time to market):**
- По сравнению с вариантом 2 дольше, т.к. 
	- требуется время на коммуникацию между разработчиками и согласование API
	- требуется самостоятельная реализация безопасности (аутентификация, авторизация, управление пользователями и ролями) 

**Стоимость:**
- Все компоненты open-source, бесплатно
- Разработчиков потребуется два: 1 front и 1 back

**Риски**
- Для разработки искать двух разработчиков разного направления

#### 2. Web-приложение на Java-фреймворке Jmix с UI

**Скорость разработки (time to market):**
- Быстро, фреймворк позволяет создавать визуальные компоненты интерфейса, просто набрасывая их на форму и создавая для них события
- Реализация безопасности из "коробки". Нужна только настройка ролей и прав доступа к интерфейсам
- Лишних коммуникаций нет, т.к. достаточно одного junior/middle-бэкендера, который может делать все - от создания модели данных и бизнес-логики до проектирования интерфейса. Достаточно знать только один язык - Java

**Стоимость:**
- Нужен только backend разработчик
- **Платная RAD лицензия в стадии активной разработки проекта**, чтобы получить все преимущества разработки Jmix:  
	конструктор модели данных, конструктор экранов, механизм миграции базы данных, конструктор запросов к данным.  
	Стоимость 90$ на 1 разработчика в месяц https://www.jmix.io/subscription-plans-and-prices/
	*На этапе поддержки готового приложения платная лицензия не нужна*

**Возможности**
Ограничение возможностями фреймворка. Но это компенсируется тем, что разработчик может пользоваться всей экосистемой Spring и Java (фреймворк это не затрудняет). Кроме того фреймворк позволяет использовать сторонние JavaScript / TypeScript / CSS.

**Риски**
Фреймворк подходит, если количество одновременно подключенных пользователей до 10 тыс. Если количество пользователей слишком вырастет, нужно будет выбрать другое решение.
## Сравнительная оценка альтернатив, и базовое решение

**Backend Java + frontend  React**
стоимость: \$$
скорость: TT

**Web-приложение на Java-фреймворке Jmix с UI**
стоимость: \$ (экономим на оплате фронтендера)
скорость: T

Вариант Web-приложение на Jmix кажется самым приемлемым